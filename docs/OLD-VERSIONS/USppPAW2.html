
<p class="TitrePrincipal"> <a id="Top" name="Top"></a><span style="color: rgb(0, 51, 102);"><small><span style="font-weight: bold;">How to build PAW atomic data for Abinit
using</span> <a style="font-weight: bold;" href="http://www.physics.rutgers.edu/%7Edhv/uspp" target="_blank">USPP</a>
<span style="font-weight: bold;">generator</span></small></span></p>
<p style="text-align: right;" class="TexteSimple"> <span style="font-size: 11pt; color: rgb(153, 51, 0);">Current
version of <em>USpp2Abinit</em> :</span><strong><span style="font-size: 14pt; color: rgb(153, 51, 0);">v2.4.0</span></strong></p>
<p style="text-align: right;" class="TexteSimple"> <span style="font-style: normal; color: rgb(0, 153, 0);">Available
for</span> <span style="color: rgb(0, 153, 0);">Abinit
v5.4.3+<br /><font style="font-style: italic;" size="-1">See this <a
            href="./previousversions.html">note</a> for use with previous
        versions of
Abinit</font></span></p>
<p style="margin-left: 40px;" class="Encadre">
<em></em></p>
<p style="text-align: right;" class="TexteSimple">&nbsp;</p>
<p style="margin-left: 40px;" class="Encadre"> <em>To obtain PAW atomic
data for Abinit we proceed
as follows:</em><em><br />
&nbsp;&nbsp;&nbsp; - We patch D. Vanderbilt's USPP package in order to
make it generate PAW atomic data in Abinit's format (in addition to
ultrasoft pseudopotentials).</em> <em><br />
&nbsp;&nbsp;&nbsp; - "Patched" USPP is directly useable to produce PAW
atomic data from normal USPP input files.</em></p>
<div style="text-align: right; height: 29px;"> <small>Many thanks to <a href="http://www.physics.rutgers.edu/%7Edhv" target="_blank">D.
Vanderbilt</a> for having given us the opportunity to use USPP package.</small></div>
<p class="TitreChapitre1"> 1. What you need:<a id="WhatYouNeed" name="WhatYouNeed"></a></p>
<ul class="PuceCroix">
<li class="PuceCroix"> <span style="font-weight: bold;">USPP</span>
ultrasoft pseudopotentials generator (<span style="font-style: italic;">version
7.3.6</span> or higher)<br /> <em>This code
is written in Fortran 77</em> </li> <li>
<p class="PuceCroix">
<strong>USpp2Abinit</strong> add-on tu USPP<br /> <em>This
code is written in Fortran 90</em></p>
</li> <li>A Linux/Unix
workstation with (at least) following tools:<br /> <span style="font-weight: bold;">Fortran 90 compiler</span> with F77
libraries, <span style="font-weight: bold;">sed</span> stream editor, <span style="font-weight: bold;">make</span> utility. </li></ul>
<div style="margin-left: 40px;"> <span style="color: rgb(204, 0, 0);">We
suppose for the following that the reader is</span> <span style="font-weight: bold; color: rgb(204, 0, 0);">familiar with the
use of USPP package.</span><br /> If not, first take at look at the
complete <a href="http://www.physics.rutgers.edu/%7Edhv/uspp/#DOCUMENTATION" target="_blank">user's
guide</a> written for it.</div>
<dl class="TexteSimple TitreChapitre1"> <dt> 2. Preliminary steps:
patching USPP<a id="PreliminarySteps" name="PreliminarySteps"></a> </dt></dl>
<ul> <li class="PuceRond"> Download&nbsp;<em style="font-weight: bold;"><span style="color: rgb(0, 102, 153);">USPP</span></em> package. You
can find it <a href="http://www.physics.rutgers.edu/%7Edhv/uspp#DOWNLOAD" target="_blank">here</a>. Be sure to download version <strong>7.3.6</strong> or
higher (including some modif. for <em>Abinit)</em><small>.</small> </li> <li class="PuceRond"> Extract <em style="font-weight: bold;"><span style="color: rgb(0, 102, 153);">USPP</span></em> (in some <em><span style="color: navy;">/uspp-xy</span></em><span style="color: navy;">z</span>directory) </li></ul>
<ul> <li class="PuceRond"> Download <em style="font-weight: bold;"><span style="color: rgb(0, 102, 153);">USpp2Abinit</span></em> package.
You can find it <a href="../ATOMICDATA/USpp2Abinit.tgz">here</a> (<span
            style="font-weight: bold;">fully compatible with ABINIT v6.1.0+;
        partly compatible with ABINIT v5.4.3+</span>).<font
            style="font-style: italic;" size="-1"><br />See this <a
            title="Use of USPP2Abinit with previous versions of ABINIT" class="internal-link" href="./previousversions.html">note</a> for use of USpp2Abinit with
versions 4.6.x-6.0.x of ABINIT.</font><small><a href="USpp2Abinit.old.tgz"><br />Here</a> USpp2Abinit for Abinit
v4.3.x-v.4.5.x (buggy !, only for tests).</small> </li></ul>
<ul>
<li class="PuceRond"> Extract <em style="font-weight: bold;"><span style="color: rgb(0, 102, 153);">Uspp2Abinit</span></em> into <span style="font-weight: bold;">USPP</span> directory (in <em><span style="color: navy;">/uspp-xy</span></em><span style="color: navy;">z<em>/USpp2Abinit.vx.y.z</em></span> directory).<br /> <small>Note that you also get a
new&nbsp;</small> <small><em><span style="color: navy;">/uspp-xy</span></em><span style="color: navy;">z<em>/utils-uspp</em>
<span style="color: rgb(0, 0, 0);">directory</span></span></small> </li></ul>
<ul> <li class="PuceRond"> Go
into&nbsp;<em><span style="color: navy;">/uspp-xyz/Uspp2Abinit</span></em><span style="color: navy;"><em>.vx.y.z</em></span> directory and edit <em><span style="color: navy;">Makefile</span></em> file;
modify it according to your machine specifications. </li> <li class="PuceRond"> Into <em><span style="color: navy;">/uspp-xyz/Uspp2Abinit</span></em><span style="color: navy;"><em>.vx.y.z</em></span> directory, </li></ul>
<div style="margin-left: 2em;" class="PuceCroix2">
<ul> <li> Type: <em><span style="color: maroon;">make</span></em><span style="font-size: 10pt;"><br />
It compiles a patched version of</span> <em><span style="font-size: 10pt; color: rgb(0, 102, 153);">USPP</span></em>
<span style="font-size: 10pt;">(with Abinit PAW add-ons)
and creates</span> <span style="font-size: 10pt; color: navy;">runatom.x</span> <span style="font-size: 10pt;">in</span> <em><span style="font-size: 10pt; color: navy;">/uspp-xy</span></em><span style="font-size: 10pt; color: navy;">z<em>/USpp2Abinit</em></span><span style="color: navy;"><em>.vx.y.z</em></span><span style="font-size: 10pt;">directory</span> </li> <li> Type : <em><span style="color: maroon;">make install</span></em><span style="font-size: 10pt;"><br /> It installs "patched"</span> <span style="font-size: 10pt; color: navy;">runatom.x</span> <span style="font-size: 10pt;">into</span> <span style="font-size: 10pt; color: navy;">/uspp-xyz/Bin</span>
<span style="font-size: 10pt;">directory</span> </li></ul>
</div>
<div style="margin-left: 2em;" class="PuceCroix2">
<ul> <li> <small><em>Optional</em>:Type : <em><span style="color: maroon;">make clean</span></em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span style="font-size: 10pt;">it cleans up</span> <span style="font-size: 10pt; color: navy;">/uspp-xyz/Uspp2Abinit</span><span style="color: navy;"><em>.vx.y.z</em></span> <span style="font-size: 10pt;">directory</span><br /> or : <em><span style="color: maroon;">make clean_all</span></em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size: 10pt;">it cleans up</span> <span style="font-size: 10pt; color: navy;">/uspp-xyz/Uspp2Abinit</span><span style="color: navy;"><em>.vx.y.z</em></span> <span style="font-size: 10pt;">and</span> <span style="font-size: 10pt; color: navy;">/uspp-xyz/Source</span><span style="font-size: 10pt;"> directories</span></small> </li></ul>
<ul> <li> At this stage you get a
patched version of <span style="font-weight: bold; font-style: italic; color: rgb(51, 102, 102);">USPP</span>
package; you can use it like original USPP. </li></ul>
</div>
<p class="TitreChapitre1"> 3.&nbsp;Generating a&nbsp; PAW
"pseudopotential file" for Abinit:<a id="GeneratingPseudopotential" name="GeneratingPseudopotential"></a></p>
<ul> <li class="PuceCroix">
Simply use <span style="font-weight: bold;">USPP</span>
as if you wanted to generate an ultrasoft pseudopotential ! </li></ul>
<p class="PetiteNote"> <span style="font-size: 10pt;">Go into <span style="font-style: italic; color: rgb(0, 0, 153);">/uspp-xyz/Work</span>
directory; browse down sub-directories, selecting chemical specie and
density functional (LDA, GGA).</span><span style="font-size: 10pt;"><br /> Type</span> <em><span style="font-size: 10pt; color: maroon;">make clean; make</span></em><span style="font-weight: bold;"><br /> If you encounter some error during
execution, look for an error message in the <span style="color: rgb(51, 102, 102);">??_ae.out</span> or <span style="color: rgb(51, 102, 102);">??_ps.out</span> file; if the error
message is not explicit enough, look at</span> <a style="font-weight: bold;" href="http://www.physics.rutgers.edu/%7Edhv/uspp/uspp-735/Doc/TUTORIAL" target="_blank">Doc/TUTORIAL</a><span style="font-weight: bold;">
(most
of the problems are referenced inside).</span></p>
<ul class="PuceCroix"> <li> And you get a
<em><span style="color: navy;">X.abinit.paw</span></em> file (<em><span style="color: navy;">X</span></em>=generic name)
directly useable by Abinit ! </li> <li style="text-decoration: underline; font-weight: bold;" class="PuceCroix"> Additional options:
</li></ul>
<div style="margin-left: 2em;">
<ul> <li class="PuceCroix2"> <span style="font-style: italic;">A file named</span>
<span style="font-weight: bold; color: rgb(51, 102, 102); font-style: italic;">uspp2abinit.dat</span>
<span style="font-style: italic;">can be added in the working directory
to pass arguments to the USpp2Abinit converter.</span><a
            style="font-style: italic;" href="./uspp2abinit.dat"
            target="_self"><br />
Here</a><span style="font-style: italic;">, an example of this file,
with details on the different keywords.</span> </li></ul>
</div>
<div style="margin-left: 2em;">
<ul> <li class="PuceCroix2">Note: if you
want to use Abinit prior version 5.2 (especially v4.6.x), you HAVE TO
use the COMPAT46 keyword in <span style="font-style: italic; color: rgb(51, 102, 102);">uspp2abinit.dat</span>
file. </li></ul>
</div>
<div style="margin-left: 2em;">
<ul> <li class="PuceCroix2">Note for experienced users:<br /> If you want to use "<strong>Real Space Optimisation</strong>" <strong>to
improve the behaviour of non-local projectors</strong>, you have to use
specific keywords in <span style="font-style: italic; color: rgb(51, 102, 102);">uspp2abinit.dat</span>
file. </li></ul>
</div>
<p style="margin: 6pt 0cm 0.0001pt 44.8pt; text-indent: -17.85pt;">&nbsp;</p>
<div style="margin-left: 40px;">
<div style="margin-left: 40px;"> <small>Real
Space Optimisation improve the development of non-local projectors by
"smoothing" their development over large G vectors (introducing a
"controlled" error). It has been proposed by King-Smith and al. (see
[4] below).</small><small><br /> The scheme is governed by 3 parameters:
Gmax (=2*Ecut**2), Gamma and Wl ; the user has to give these parameters
in <span style="font-style: italic;">uspp2abinit.dat</span> file.<br />
The efficiency of Real Space Optimization strongly depends on the
non-local projectors produced by USPP (it can be sometimes unuseful);
only experienced users should use it...&nbsp;</small></div>
</div>
<p>&nbsp;</p>
<p style="font-weight: bold;" class="TitreChapitre1"> 4. Additional
remarks:<a id="AdditionalRemarks" name="AdditionalRemarks"></a></p>
<ul>
<li class="PuceCroix2"> <span style="color: windowtext;">You
can as a first step use <strong>input files</strong> <em>(</em></span><em><span style="color: navy;">*.adat</span></em> <span style="color: windowtext;">files) <strong>distributed by D.
Vanderbilt</strong> on his</span> <span style="color: windowtext;"><a href="http://www.physics.rutgers.edu/%7Edhv/uspp/table.html" target="_blank">web site</a></span><span style="color: windowtext;">.</span><span style="color: windowtext; font-style: normal;"><br /> But
we recommend to make additional tests before using those input files.
PAW formalism is a bit different from US pseudopotentials one and can
induce a different behaviour of atomic data.</span> </li> <li class="PuceCroix2"> <span style="color: windowtext; font-style: normal;">The choice
of a</span> <strong><span style="color: windowtext; font-style: normal;">density
functional</span></strong><span style="color: windowtext; font-style: normal;">is limited
by functionals included in</span> <span style="color: rgb(0, 102, 153);">USPP</span> <span style="color: windowtext; font-style: normal;">package
and in</span> <span style="color: rgb(0, 102, 153);">Abinit</span><span style="color: windowtext; font-style: normal;">.<br /> To
be used a density functional model must be incorporated into both
packages.</span><span style="color: windowtext; font-style: normal;"><br /> Only four functionals are programmed in</span> <span style="color: rgb(0, 102, 153);">USPP</span> <span style="color: windowtext; font-style: normal;">and</span>
<span style="color: rgb(0, 102, 153);">Abinit</span> <span style="color: windowtext; font-style: normal;">together:</span>
<span style="color: maroon; font-style: normal;">Ceperley-Adler
(LDA), Wigner (LDA), Hedin-Lundqvist (LDA), Perdew-Burke-Ernzerhof 96
(GGA)</span> </li> <li class="PuceCroix2">In order to check the
validity of atomic data produced by USPP, a simple test is the
comparison of the <span style="font-weight: bold; text-decoration: underline;">logarithmic
derivatives of wave functions</span> (exact ones compared to pseudo
ones).<br /> A simple PYTHON script <span style="font-weight: bold; color: rgb(51, 102, 102);">pltlogd</span> is
provided within <span style="font-weight: bold;">USpp2Abinit</span>
package in <span style="color: rgb(0, 0, 153);">/uspp-xyz/utils-uspp</span>
directory to plot these derivatives. It uses the <span style="color: rgb(51, 102, 102); font-style: italic;">??.logd</span>
file produced by USPP.<br /> Just type: <span style="font-style: italic; color: rgb(0, 0, 153);">pltlogd file.logd l</span>,
&nbsp; &nbsp; &nbsp; &nbsp;where <span style="font-style: italic;">l</span>
is an angular momentum (0, 1, 2, or 3). </li></ul>
<p class="TitreChapitre2"> 5.&nbsp;References:<a id="References" name="References"></a></p>
<div style="margin-left: 40px;"> <span style="font-weight: bold;">[1]</span>&nbsp;&nbsp;<span style="color: windowtext;"><a href="http://www.physics.rutgers.edu/%7Edhv/pubs/local_copy/uspp_1.pdf">Soft
Self-Consistent Pseudopotentials in a Generalized Eigenvalue Formalism</a>,</span><br />
<span style="color: windowtext;">D. Vanderbilt, Phys.</span> <span style="color: windowtext;">Rev. B 41&nbsp;
(Rapid Communications), 7892 (1990)</span></div>
<p style="margin-left: 40px;"> <span style="font-weight: bold;">[2]</span>&nbsp;<span style="color: windowtext;"><a href="http://www.physics.rutgers.edu/%7Edhv/pubs/local_copy/uspp_2.pdf">Implementation
of Ultra-Soft Pseudopotentials in Ab-initio Molecular Dynamics</a>,</span><span style="color: windowtext;"><br /> K. Laasonen, R. Car, C.
Lee, D. Vasnderbilt, Phys. Rev. B 43 (Rapid Communications), 6796 (1991)</span></p>
<div style="margin-left: 40px;"> <span style="font-weight: bold;">[3]</span>&nbsp;From ultrasoft pseudopotentials to the projector
augmented-wave method,<span style="color: windowtext;"><br /> G. Kresse, D. Joubert, Phys. Rev. B 59, 1758 (1999)</span></div>
<div style="margin-left: 40px;">
<p> <span style="font-weight: bold;">[4]</span>&nbsp; Real-space implementation
of nonlocal pseudopotentials for 1st-principle total-energy
calculations,<br /> R.D. King-Smith, M.C. Payne, J.S. Lin, Phys. Rev. B
44, 13063 (1991)</p>
<p><span style="font-weight: bold;">[5]</span>&nbsp;
<a class="external-link" href="http://dx.doi.org/10.1016/j.commatsci.2007.07.020">Implementation of the projector augmented-wave method in the ABINIT
code: Application to the study of iron under pressure</a>,<br />M. Torrent,
F. Jollet, F. Bottin, G. Zerah and X. Gonze, Comput. Mater. Sci.
42, 337 (2008)</p>
</div>
<dl> <dt class="TitreChapitre2"> <br />
6.&nbsp;Contacts:<a id="Contacts" name="Contacts"></a> </dt></dl>
<dl style="margin-left: 40px;"> <dt> In case of problem or questions
contact the authors.<br /> <br /> <span style="font-style: italic;">Marc Torrent</span><br />
<span style="font-style: italic;">FranÃ§ois Jollet</span><br /> <span style="font-style: italic;">DÃ©partement de Physique
ThÃ©orique et AppliquÃ©e</span><br /> <span style="font-style: italic;">CEA, DAM, DIF</span><br /> <span style="font-style: italic;">F-91127 Arpajon</span><br />
<span style="font-style: italic;">France</span> </dt></dl>
<p style="text-align: left; margin-left: 0px; width: 244px;" class="PetiteNote"> Last modification : may 11th 2010</p>
