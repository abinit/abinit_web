<!DOCTYPE html>
<html lang="en">
<head>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"  crossorigin="anonymous" />
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
  <link href="../../styles.css"
        rel="stylesheet"> <!-- Link to your external CSS file -->
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Information on the format 6 for pseudopotentials</title>
<style>
      body {
    font-family: Arial, sans-serif;
    line-height: 1.6;
    margin-left: 200px;
  }
  .sectionedit1 {
    font-size: 1.5em;
    margin-top: 0;
  }
  .level3 {
    margin-top: 10px;
  }
  .code {
    background-color: #f0f0f0;
    padding: 10px;
    margin: 10px 0;
    white-space: pre-wrap;
  }
  .co0 {
    color: green;
  }
  .shell {
    color: blue;
  }
</style>
</head>
<body>
<div class="burger-menu" onclick="toggleMenu()">&#9776;</div>
<div class="icon-container">
    <div class="icon-row">
        <div >
            <a href="../../index.html">
                <img alt="ABINIT" src="../../logo/logo.png" class="logo"
                     title="" height="100" />
                <span class="title"></span>
            </a>
        </div>

    </div>

    <div class="icon-row">
        <div class="icon">
            <a href="../../pseudopotential.html">
                <img alt="Pseudo and atomic data" class="icon" src="../../img/Pseudos.png" title="pseudopotential" />
                <span class="title">Pseudos &amp; PAW data</span>
            </a>
        </div>
        <div class="icon">
            <a href="https://docs.abinit.org/variables">
                <img alt="input variables" class="icon" src="../../img/input_variables.png" title="Input variables" />
                <span class="title">Input variables</span>
            </a>
        </div>
        <div class="icon">
            <a href="https://docs.abinit.org/tutorial/">
                <img alt="Tutorials" class="icon" src="../../img/Tutorials.png" title="Tutorials" />
                <span class="title">Tutorials</span>
            </a>
        </div>
        <div class="icon">
            <a href="https://discourse.abinit.org/">
                <img alt="Forum" class="icon" src="../../img/Forum.png" title="Forum" />
                <span class="title">Forum</span>
            </a>
        </div>
        <div class="icon">
            <a href="https://github.com/abinit/abinit/releases/latest">
                <img alt="Download" class="icon" src="../../img/Download.png" title="Download" />
                <span class="title">Download</span>
            </a>
        </div>
        <div class="icon">
            <a href="https://docs.abinit.org/installation/">
                <img alt="Compile" class="icon" src="../../img/Compile.png" title="Compile" />
                <span class="title">Compile</span>
            </a>
        </div>
            <div class="icon">
            <a href="https://github.com/abinit">
                <img alt="GitHub" class="icon" src="../../img/git.png" title="GitHub" />
                <span class="title">GitHub</span>
            </a>
        </div>
        <div class="icon">
            <a href="https://gui.abinit.org/">
                <img alt="GUI" class="icon" src="../../img/gui.png" title="GUI" />
                <span class="title">GUI</span>
            </a>
        </div>
        <div class="icon">
            <a href="https://github.com/abinit/abipy">
                <img alt="abipy" class="icon" src="../../img/abipy.png" title="abipy" />
                <span class="title">Abipy</span>
            </a>
        </div>
</div>
</div>
    <script>
        function toggleMenu() {
            const iconContainer = document.querySelector('.icon-container');
            iconContainer.classList.toggle('active');
        }
    </script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<div class="separator-line1"></div>

<h3 class="sectionedit1" id="information_on_the_format_6_for_pseudopotentials">Information on the format 6 for pseudopotentials</h3>

  <div class="level3">
    <p>
      The format 6 for ABINIT pseudopotentials allows to use pseudopotentials
      generated from the FHI98PP code (Fritz-Haber-Institute, Berlin).
      This code is available at <abbr title="Uniform Resource Locator">URL</abbr>
      <a href="http://www.FHI-Berlin.MPG.DE/th/fhi98md/fhi98PP" class="urlextern"
      title="http://www.FHI-Berlin.MPG.DE/th/fhi98md/fhi98PP" rel="ugc nofollow">
      http://www.FHI-Berlin.MPG.DE/th/fhi98md/fhi98PP</a>.
    </p>

    <p>
      A few lines must be added to the file generated by the FHI98PP code,
      and are described in the present file. ABINITv1.9 is able to
      read format 6 pseudopotential files without core correction.
      ABINITv2.2 is able to read them with core correction (thanks to AF).
    </p>

    <p>
      1) The original cpi file
    </p>

    <p>
      We will suppose that the user has been able to generate a 'cpi' file from the FHI98PP code.
      There is one such file in the ~abinit/tests/Psps_for_tests directory,
      with the name al_h.cpi (the FHI98PP code generated a file named “al:h.cpi”, but the name was changed,
      to allow portability under DOS/Windows) .
      It begins by:
    </p>
    <pre class="code">0.30000000000000E+01   3
  0.0000    0.0000    0.0000   0.0000
  0.0000    .00e+00   .00e+00
  0.0000    .00e+00   .00e+00
  0.0000    .00e+00   .00e+00
  0.0000    .00e+00   .00e+00
  0.0000    .00e+00   .00e+00
  0.0000    .00e+00   .00e+00
  0.0000    .00e+00   .00e+00
  0.0000    .00e+00   .00e+00
493  0.10247000000000E+01
   1 0.48076923076923E-03 0.91926957204792E-04 0.72762392428392E+00
   2 0.49264423076923E-03 0.94197553047751E-04 0.72762434262851E+00
   3 0.50481254326923E-03 0.96524232608030E-04 0.72762477651319E+00
...
...</pre>

    <p>
      From these numbers, we will make direct use of:
    </p>
    <ol>
      <li>those on the first line, i.e. the number of valence electrons (0.30000000000000E+01) and the number of pseudopotential components (3)</li>
      <li>the first on the 12th line, i.e. the number of mesh points (493)</li>
    </ol>

    <p>
      2) The new file
    </p>

    <p>
      For the purpose of generating the corresponding file readable by ABINIT (also
      found in the ~abinit/tests/Psps_for_tests directory, with the name 13al.981214.fhi),
      the following seven lines have been added at the beginning of the al_h.cpi file:
    </p>
    <pre class="code">Aluminum, fhi98PP : Hamann-type, LDA CA PerdewWang, l=2 local
 13.000  3.000    981214              zatom,zion,pspdat
 6       7        2   2    493     0  pspcod,pspxc,lmax,lloc,mmax,r2well
 0.0     0.0     0.0                  rchrg, fchrg, qchrg
5--- These two lines are available for giving more information, later
6
7-Here follows the cpi file from the fhi98pp code-</pre>

    <p>
      Similar lines must be added at the beginning of other cpi files, in order
      to make them readable by ABINIT.
    </p>

    <p>
      Line 1 is simply a header, that might include any information, and that will
      be printed without modification in the output of ABINIT.
    </p>

    <p>
      Line 2 describes:
    </p>
    <ol>
      <li>the atomic number (zatom);</li>
      <li>the ionic charge (zion, number of valence electrons);</li>
      <li>the date of pseudopotential generation.</li>
    </ol>

    <p>
      The two first information are crucial, the third one is not
      really important. The atomic number is 1 for Hydrogen, 8 for Oxygen, and so on.
      The ionic charge should be the same number as the first number mentioned
      in the cpi file (called 'number of valence electrons').
    </p>

    <p>
      Line 3 describes:
    </p>
    <ol>
      <li>the format of the pseudopotential (pspcod ; must be 6 for this format);</li>
      <li>the XC functional used to generate the pseudopotential (pspxc; the same numbers as for the input variable ixc should be used, see ~abinit/doc/users/abinit_help.html)</li>
      <li>the maximal angular momentum of the wavefunctions described in the pseudopotential file (lmax=0 if only s-wavefunctions are present, lmax=1 for s and p wfs, lmax=2 for s, p and d wfs … ; lmax+1 must be equal to the 'number of pseudopotential components' mentioned in the cpi file, as the second number of the first line)</li>
      <li>the angular momentum of the potential to be used as local pseudopotential (lloc=0 if s-potential is local; lloc=1 if p-potential is local; … )</li>
      <li>the number of radial mesh points (mmax, same meaning as in the cpi file; first number on the 12th line)</li>
      <li>the last number can be set to 0.</li>
    </ol>

    <p>
      Line 4 describes 3 parameters needed to read the model core-charge if core correction is needed.
    </p>
    <ol>
      <li>rchrg: radius at which the core charge vanish (i.e. cut-off in a.u.)</li>
      <li>fchrg: amplitude of core charge (if =0 non core-correction performed, if &gt;0 core-correction is applied). The specific value of fchrg has no physical meaning in fhi98pp scheme of core correction.</li>
      <li>qchrg: integrated model core charge (it's not actually used by abinit, and can be set to any value)</li>
    </ol>

    <p>
      rchrg can be inferred by the pp file. Indeed, if the pp has been generated
      with the core-correction option, at the end of 'cpi' file there will be:
    </p>
    <pre class="code">   do i=1,mmax
     rad(i), f(i), f1(i), f2(i)
   end do</pre>

    <p>
      that is, the radial grid, the core charge (f), and their first(f1)
      and second (f2) derivative on the radial mesh; rchrg can be equal
      to any value of rad(i) to which f,f1 and f2 are reasonably vanished.
    </p>

    <p>
      Line 5-7 have no interest up to now.
    </p>

    <p>
      A pseudopotential with format 6 will be treated by
      the routine psp6in.f, that calls psp5lo.f (local part) and
      psp5nl.f (non-local part). There is no psp6lo.f or psp6nl.f .
    </p>

    <p>
      The integral of (V®+Zion/r) r^2 in psp5lo.f is performed
      from 0 to the highest allowed radius (usually about 100 a.u.),
      except that beyond 20 a.u. no value of abs(V®) larger
      than 2.0d-8 is tolerated. This will allow to cut off spurious
      behaviour of pseudopotential whose data file is written in single precision.
    </p>
  </div>
</body>
</html>
