<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Information on the format 8 for pseudopotentials</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 20px;
        }
        h3 {
            color: #333;
        }
        .code {
            background-color: #f5f5f5;
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            overflow-x: auto;
        }
        .code span {
            color: #008000;
        }
    </style>
</head>
<body>
    <h3 id="information_on_the_format_8_for_pseudopotentials">Information on the format 8 for pseudopotentials</h3>
    <div class="level3">
        <p>(Note: the implementation of format 8 was done by D. R. Hamann).</p>

        <p>
        The format 8 for ABINIT pseudopotentials is designed to allow users
        who wish to experiment with pseudopotentials, possibly with non-standard
        features, to have great flexibility in doing so.
        It does not correspond to any publicly available tabulation.
        The open-source ONCVPSP package available at <a href="http://www.mat-simresearch.com" class="urlextern" title="http://www.mat-simresearch.com" rel="ugc nofollow">www.mat-simresearch.com</a> produces pseudopotentials in this
        format.
        </p>

        <p>
        An annotated example is presented in detail below, followed by a second
        example incorporating spin-orbit coupling.  An extended discussion follows
        below the examples, with a separate section discussing spin-orbit as produced by ONCVPSP.
        </p>

        <p>
        When first producing a pseudopotential in this format, it would be a very
        good idea to do a well-converged calculation of an isolated atom in a big
        box to confirm that you are correctly recreating the atomic valence levels you intend.
        </p>

        <p>
        The format is best explained by an example, which is presented in
        detail below.  (The example is excerpted from Psps_for_tests/20ca_sic.drh.
        Another example of pspcod=8 is Psps_for_tests/8o_sic.drh.)
        All but the last data block of this file are read in subroutine psp8in.f.
        The “comment” (#) lines below are not permitted in the actual file.
        Nor are blank lines.
        </p>

        <pre class="code bash"><span>#Header</span>
<span># line 1 - Title</span>
<span># line 2 - atomic number, pseudoion charge, date</span>
<span># line 3 - pspcod=8 identifies this format</span>
<span>#          pspxc=2 identifies the exchange-correlation functional (see</span>
<span>#           ixc list in the input variables documentation)</span>
<span>#          lmax=2 gives the largest angular momentum potential present</span>
<span>#          lloc=4 (which is &gt;lmax) indicates that the local potential</span>
<span>#           is independent of that for any angular momentum.  In other</span>
<span>#           cases, it can be &lt;=lmax, and the local potential can be</span>
<span>#           that of a particular angular momentum channel.  (The choice</span>
<span>#           of 4 is arbitrary, but the index of the corresponding data block</span>
<span>#           below must be consistent with the value assigned in the header.)</span>
<span>#          mmax=313, giving the number of radial grid points (arbitrary).</span>
<span>#          r2well=0 is an historical header holdover, and is not used</span>
<span># line 4 - rchrg=6.18.. is the radius beyond which the model core</span>
<span>#           charge (if used) is zero or negligible.  The maximum</span>
<span>#           radial mesh point must equal or exceed this value.</span>
<span>#          fchrg=1.0 signals that a model core charge is present.  Any</span>
<span>#           value &gt;0.0 will do, and the value is not used otherwise.</span>
<span>#          qchrg=0.0 is a historical holdover, not used.</span>
<span># line 5 - number of Bloechl-Kleinman-Bylander projectors nproj for each</span>
<span>#          angular momentum l=0 to l=lmax.  The value of nproj for lloc </span>
<span>#          must be 0 (if lloc &lt;= lmax).</span>
<span># line 6 - extension_switch=0, not initially used, but values &gt;0 but may</span>
<span>#          be utilized to signal the presence of additonal lines of header</span>
<span>#          information for special-purpose use in the future.</span>
<span>#          The value 2 is now used to indicate the presence os spin-orbit</span>
<span>#          projectors (see SPIN-ORBIT section below).</span></pre>

        <pre class="code">  self-intraction-corrected psp for calcium (D. R. Hamann)
     20.0000      2.0000    040701    zatom,zion,pspd
     8     2     2     4   313     0    pspcod,pspxc,lmax,lloc,mmax,r2well
  6.18295050  1.00000000  0.00000000    rchrg fchrg qchrg
     2     1     1     0     0    nproj
     0                            extension_switch</pre>

        <pre class="code shell">#First data block
<span># first line - angular momentum l=0, ekb(ii) for ii=1,2(=nproj(1))</span>
<span># following lines labeled 1,2,...,mmax -</span>
<span>#    1st column: radial grid index</span>
<span>#    2nd column: radial grid mesh point (LINEAR mesh starting at 0.0)</span>
<span>#    3rd column: first  BKB projector for l=0</span>
<span>#    4th column: second BKB projector for l=0</span>
<span># The projectors should go smoothly to zero, or decay to negligible</span>
<span>#  values within the range of the radial grid.</span>
<span># In general there are nproj ekb and projector columns for each l, as</span>
<span>#  many as you want.</span>
<span># If nproj is zero, AND lloc/= the current l, this block is omitted.</span>
<span># While some may be absent, l blocks must be in ascending order.</span></pre>

        <pre class="code">   0                         1.8442549429363D+01 -1.5467656752626D+01
     1  0.0000000000000D+00  0.0000000000000D+00  0.0000000000000D+00
     2  2.0000000000000D-02  3.2695476840515D-03 -7.7803072439537D-05
     3  4.0000000000000D-02  6.5413292698932D-03 -1.5573364986856D-04
   .....
   .....
   </pre>

        <pre class="code shell">#Second data block
<span># first line - angular momentum l=1, ekb(ii) for ii=1,1(=nproj(2))</span>
<span># following lines labeled 1,2,...,mmax -</span>
<span>#    1st column: radial grid index</span>
<span>#    2nd column: radial grid mesh point</span>
<span>#    3rd column: first (only)  BKB projector for l=1</span></pre>

        <pre class="code">   1                         1.0250215833500D+01
     1  0.0000000000000D+00  0.0000000000000D+00
     2  2.0000000000000D-02  4.1259561971920D-05
     3  4.0000000000000D-02  1.6501618805883D-04
   .....
   .....</pre>

        <pre class="code shell"># Third data block
<span># as above, for l=2</span></pre>

        <pre class="code"> 2                        -4.9318560092991D-01
   1  0.0000000000000D+00  0.0000000000000D+00
   2  2.0000000000000D-02 -2.0345781270805D-06
   3  4.0000000000000D-02 -8.1259905040450D-06
.....
.....
   </pre>

        <p>
        Note that the third data block contains only one line of projectors (the one and only one in the input
         file) because nproj(3)=1 is present.
        </p>
    </div>
</body>
</html>
